# Written by Radislaw Ejsmont, Oct. 2015, during a Porquerolles course on cell modeling

#random_seed 1445013440

dim 2
boundaries 0 -20 20
boundaries 1 -20 20
time_start 0
time_stop 20000
time_step 0.05

species L LR R AL
difc R(up) 0.01
difc L(down) 0.01
difc L(up) 0.01
difc AL 1
difc L(soln) 100

color L(up) cyan
color L(soln) green
color L(down) magenta
color AL(all) red
color R(all) blue
colour LR(all) black
display_size all(all) 0.1
display_size R(all) 0.2
display_size LR(all) 0.2
display_size L(all) 1
display_size AL(all) 1

graphics opengl_good
frame_thickness 0

start_surface cell
  action both all reflect
  color front black
  color back yellow
  thickness 1
  panel tri -10.792305 -14.346410 -10.792305 -10.346410
  panel tri -14.256406 -16.346410 -10.792305 -14.346410
  panel tri -17.720508 -14.346410 -14.256406 -16.346410
  panel tri -10.792305 -10.346410 -14.256406 -8.346410
  panel tri -14.256406 -8.346410 -17.720508 -10.346410
  panel tri -17.720508 -10.346410 -17.720508 -14.346410
  panel tri -7.228203 -8.173205 -7.228203 -4.173205
  panel tri -10.692305 -10.173205 -7.228203 -8.173205
  panel tri -14.156406 -8.173205 -10.692305 -10.173205
  panel tri -7.228203 -4.173205 -10.692305 -2.173205
  panel tri -10.692305 -2.173205 -14.156406 -4.173205
  panel tri -14.156406 -4.173205 -14.156406 -8.173205
  panel tri -10.792305 -2.000000 -10.792305 2.000000
  panel tri -14.256406 -4.000000 -10.792305 -2.000000
  panel tri -17.720508 -2.000000 -14.256406 -4.000000
  panel tri -10.792305 2.000000 -14.256406 4.000000
  panel tri -14.256406 4.000000 -17.720508 2.000000
  panel tri -17.720508 2.000000 -17.720508 -2.000000
  panel tri -7.228203 4.173205 -7.228203 8.173205
  panel tri -10.692305 2.173205 -7.228203 4.173205
  panel tri -14.156406 4.173205 -10.692305 2.173205
  panel tri -7.228203 8.173205 -10.692305 10.173205
  panel tri -10.692305 10.173205 -14.156406 8.173205
  panel tri -14.156406 8.173205 -14.156406 4.173205
  panel tri -10.792305 10.346410 -10.792305 14.346410
  panel tri -14.256406 8.346410 -10.792305 10.346410
  panel tri -17.720508 10.346410 -14.256406 8.346410
  panel tri -10.792305 14.346410 -14.256406 16.346410
  panel tri -14.256406 16.346410 -17.720508 14.346410
  panel tri -17.720508 14.346410 -17.720508 10.346410
  panel tri -3.664102 -14.346410 -3.664102 -10.346410
  panel tri -7.128203 -16.346410 -3.664102 -14.346410
  panel tri -10.592305 -14.346410 -7.128203 -16.346410
  panel tri -3.664102 -10.346410 -7.128203 -8.346410
  panel tri -7.128203 -8.346410 -10.592305 -10.346410
  panel tri -10.592305 -10.346410 -10.592305 -14.346410
  panel tri -0.100000 -8.173205 -0.100000 -4.173205
  panel tri -3.564102 -10.173205 -0.100000 -8.173205
  panel tri -7.028203 -8.173205 -3.564102 -10.173205
  panel tri -0.100000 -4.173205 -3.564102 -2.173205
  panel tri -3.564102 -2.173205 -7.028203 -4.173205
  panel tri -7.028203 -4.173205 -7.028203 -8.173205
  panel tri -3.664102 -2.000000 -3.664102 2.000000
  panel tri -7.128203 -4.000000 -3.664102 -2.000000
  panel tri -10.592305 -2.000000 -7.128203 -4.000000
  panel tri -3.664102 2.000000 -7.128203 4.000000
  panel tri -7.128203 4.000000 -10.592305 2.000000
  panel tri -10.592305 2.000000 -10.592305 -2.000000
  panel tri -0.100000 4.173205 -0.100000 8.173205
  panel tri -3.564102 2.173205 -0.100000 4.173205
  panel tri -7.028203 4.173205 -3.564102 2.173205
  panel tri -0.100000 8.173205 -3.564102 10.173205
  panel tri -3.564102 10.173205 -7.028203 8.173205
  panel tri -7.028203 8.173205 -7.028203 4.173205
  panel tri -3.664102 10.346410 -3.664102 14.346410
  panel tri -7.128203 8.346410 -3.664102 10.346410
  panel tri -10.592305 10.346410 -7.128203 8.346410
  panel tri -3.664102 14.346410 -7.128203 16.346410
  panel tri -7.128203 16.346410 -10.592305 14.346410
  panel tri -10.592305 14.346410 -10.592305 10.346410
  panel tri 3.464102 -14.346410 3.464102 -10.346410
  panel tri 0.000000 -16.346410 3.464102 -14.346410
  panel tri -3.464102 -14.346410 0.000000 -16.346410
  panel tri 3.464102 -10.346410 0.000000 -8.346410
  panel tri 0.000000 -8.346410 -3.464102 -10.346410
  panel tri -3.464102 -10.346410 -3.464102 -14.346410
  panel tri 7.028203 -8.173205 7.028203 -4.173205
  panel tri 3.564102 -10.173205 7.028203 -8.173205
  panel tri 0.100000 -8.173205 3.564102 -10.173205
  panel tri 7.028203 -4.173205 3.564102 -2.173205
  panel tri 3.564102 -2.173205 0.100000 -4.173205
  panel tri 0.100000 -4.173205 0.100000 -8.173205
  panel tri 3.464102 -2.000000 3.464102 2.000000
  panel tri 0.000000 -4.000000 3.464102 -2.000000
  panel tri -3.464102 -2.000000 0.000000 -4.000000
  panel tri 3.464102 2.000000 0.000000 4.000000
  panel tri 0.000000 4.000000 -3.464102 2.000000
  panel tri -3.464102 2.000000 -3.464102 -2.000000
  panel tri 7.028203 4.173205 7.028203 8.173205
  panel tri 3.564102 2.173205 7.028203 4.173205
  panel tri 0.100000 4.173205 3.564102 2.173205
  panel tri 7.028203 8.173205 3.564102 10.173205
  panel tri 3.564102 10.173205 0.100000 8.173205
  panel tri 0.100000 8.173205 0.100000 4.173205
  panel tri 3.464102 10.346410 3.464102 14.346410
  panel tri 0.000000 8.346410 3.464102 10.346410
  panel tri -3.464102 10.346410 0.000000 8.346410
  panel tri 3.464102 14.346410 0.000000 16.346410
  panel tri 0.000000 16.346410 -3.464102 14.346410
  panel tri -3.464102 14.346410 -3.464102 10.346410
  panel tri 10.592305 -14.346410 10.592305 -10.346410
  panel tri 7.128203 -16.346410 10.592305 -14.346410
  panel tri 3.664102 -14.346410 7.128203 -16.346410
  panel tri 10.592305 -10.346410 7.128203 -8.346410
  panel tri 7.128203 -8.346410 3.664102 -10.346410
  panel tri 3.664102 -10.346410 3.664102 -14.346410
  panel tri 14.156406 -8.173205 14.156406 -4.173205
  panel tri 10.692305 -10.173205 14.156406 -8.173205
  panel tri 7.228203 -8.173205 10.692305 -10.173205
  panel tri 14.156406 -4.173205 10.692305 -2.173205
  panel tri 10.692305 -2.173205 7.228203 -4.173205
  panel tri 7.228203 -4.173205 7.228203 -8.173205
  panel tri 10.592305 -2.000000 10.592305 2.000000
  panel tri 7.128203 -4.000000 10.592305 -2.000000
  panel tri 3.664102 -2.000000 7.128203 -4.000000
  panel tri 10.592305 2.000000 7.128203 4.000000
  panel tri 7.128203 4.000000 3.664102 2.000000
  panel tri 3.664102 2.000000 3.664102 -2.000000
  panel tri 14.156406 4.173205 14.156406 8.173205
  panel tri 10.692305 2.173205 14.156406 4.173205
  panel tri 7.228203 4.173205 10.692305 2.173205
  panel tri 14.156406 8.173205 10.692305 10.173205
  panel tri 10.692305 10.173205 7.228203 8.173205
  panel tri 7.228203 8.173205 7.228203 4.173205
  panel tri 10.592305 10.346410 10.592305 14.346410
  panel tri 7.128203 8.346410 10.592305 10.346410
  panel tri 3.664102 10.346410 7.128203 8.346410
  panel tri 10.592305 14.346410 7.128203 16.346410
  panel tri 7.128203 16.346410 3.664102 14.346410
  panel tri 3.664102 14.346410 3.664102 10.346410
  panel tri 17.720508 -14.346410 17.720508 -10.346410
  panel tri 14.256406 -16.346410 17.720508 -14.346410
  panel tri 10.792305 -14.346410 14.256406 -16.346410
  panel tri 17.720508 -10.346410 14.256406 -8.346410
  panel tri 14.256406 -8.346410 10.792305 -10.346410
  panel tri 10.792305 -10.346410 10.792305 -14.346410
  panel tri 21.284610 -8.173205 21.284610 -4.173205
  panel tri 17.820508 -10.173205 21.284610 -8.173205
  panel tri 14.356406 -8.173205 17.820508 -10.173205
  panel tri 21.284610 -4.173205 17.820508 -2.173205
  panel tri 17.820508 -2.173205 14.356406 -4.173205
  panel tri 14.356406 -4.173205 14.356406 -8.173205
  panel tri 17.720508 -2.000000 17.720508 2.000000
  panel tri 14.256406 -4.000000 17.720508 -2.000000
  panel tri 10.792305 -2.000000 14.256406 -4.000000
  panel tri 17.720508 2.000000 14.256406 4.000000
  panel tri 14.256406 4.000000 10.792305 2.000000
  panel tri 10.792305 2.000000 10.792305 -2.000000
  panel tri 21.284610 4.173205 21.284610 8.173205
  panel tri 17.820508 2.173205 21.284610 4.173205
  panel tri 14.356406 4.173205 17.820508 2.173205
  panel tri 21.284610 8.173205 17.820508 10.173205
  panel tri 17.820508 10.173205 14.356406 8.173205
  panel tri 14.356406 8.173205 14.356406 4.173205
  panel tri 17.720508 10.346410 17.720508 14.346410
  panel tri 14.256406 8.346410 17.720508 10.346410
  panel tri 10.792305 10.346410 14.256406 8.346410
  panel tri 17.720508 14.346410 14.256406 16.346410
  panel tri 14.256406 16.346410 10.792305 14.346410
  panel tri 10.792305 14.346410 10.792305 10.346410
  rate L down fsoln 0.1
  rate L fsoln up 100
  rate L bsoln down 0.1
end_surface

start_compartment incell
  surface cell
  point -14.256406 -12.346410
  point -10.692305 -6.173205
  point -14.256406 0.000000
  point -10.692305 6.173205
  point -14.256406 12.346410
  point -7.128203 -12.346410
  point -3.564102 -6.173205
  point -7.128203 0.000000
  point -3.564102 6.173205
  point -7.128203 12.346410
  point 0.000000 -12.346410
  point 3.564102 -6.173205
  point 0.000000 0.000000
  point 3.564102 6.173205
  point 0.000000 12.346410
  point 7.128203 -12.346410
  point 10.692305 -6.173205
  point 7.128203 0.000000
  point 10.692305 6.173205
  point 7.128203 12.346410
  point 14.256406 -12.346410
  point 17.820508 -6.173205
  point 14.256406 0.000000
  point 17.820508 6.173205
  point 14.256406 12.346410
end_compartment

reaction compartment=incell l_prod 0 -> L 0.01
reaction binding L(up) + R(up) -> LR(up) 0.1
reaction recycling LR(up) -> R(up) + AL(bsoln) + AL(bsoln) + AL(bsoln) + AL(bsoln) + AL(bsoln) 100
reaction annihilation L + AL -> 0 100

surface_mol 1000 R(up) cell all all

text_display time L AL 
#output_files output.txt

end_file
